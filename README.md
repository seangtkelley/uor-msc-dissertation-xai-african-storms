# Using machine learning to predict the intensification and propagation of East African storms

## Metadata
- **University**: [University of Reading](https://www.reading.ac.uk/)
- **Master's Program**: [MSc Climate Change and Artificial Intelligence (CCAI)](https://www.reading.ac.uk/ready-to-study/study/2025/meteorology-and-climate-pg/msc-climate-change-and-artificial-intelligence) 2024-2025 
- **Student**: Sean Kelley
- **Primary Supervisor**: [Eliza Karlowska](https://research.reading.ac.uk/meteorology/people/eliza-karlowska/)
- **Co-supervisors**: [Kieran Hunt](https://research.reading.ac.uk/meteorology/people/kieran-hunt/), [Andy Turner](https://research.reading.ac.uk/meteorology/people/andrew-turner/)

## Folder Structure

For the instructions below, the use of `REPO_ROOT` will refer to the fully qualified directory path where the repository is cloned.

- `REPO_ROOT/`
  - `data`: Data files
  - `figures`: Figures and table files generated by code
  - `report`: Latex report files
  - `src`: Python code and Jupyter notebooks

## Minimum Setup Instructions

The following instructions assume you have `python` installed.

### Conda

Recommended for complete python environment isolation.

1. [Install conda](https://docs.conda.io/projects/conda/en/latest/user-guide/install/index.html)
2. `conda env create -f environment.yml`
3. `conda activate uor-msc-dissertation-xai-african-storms`

### Venv

1. `pip install venv`
2. `python -m venv venv`
3. `source venv/bin/activate`
4. `pip install -r requirements.txt`

## Data Description

### Storm Database
- file: `East_Africa_tracked_MCSs_2014_2019_longer_than_3_hours.csv`
- 27,982 storms longer than 3 hours and that had all storm centroids along the track within (3-15N, 34-52E)

### ERA5 Data
- ERA5 data for 31-53E, 2-16N region for 2014-2019, in total 27 GB. The ERA5 area is wider by a few grid points for edge cases in the database + for calculating gradients

#### Folder Structure
- `raw/` - no data here, Eliza has all the preprocessed data on her own jasmin gsw
- `std/` - all preprocessed data is stored here, should be in the same format, some variables are on different grids (T vs U grid)
- `processed/` - I advise to save processed data in this directory, e.g. gradients etc so we don’t accidentally overwrite std/ data

#### Invariant Data:

| File Pattern | Description | Units/Notes |
|--------------|-------------|-------------|
| `geop.nc` | Geopotential | m2/s2 (divide by 9.81 m/s to get orography) |
| `lsm.nc` |  land-sea mask | Boolean |

#### Hourly data stored in yearly files:

| File Pattern | Description | Units/Notes |
|--------------|-------------|-------------|
| `cape_0_*.nc` | Convective available potential energy | J/kg |
| `olr_toa_*.nc` | Top-of-atmosphere outgoing longwave flux (proxy for convection/clouds) | W/m² |
| `prcp_tot_*.nc` | Thickness of rainfall amount (hourly accumulations) | m |
| `rhum_*_*.nc` | Relative humidity at 500, 750 and 900 hPa | % [was used for theta e calculations] |
| `shum_*_*.nc` | Specific humidity at 200, 500, 850 hPa | kg/kg |
| `skt_sfc_*.nc` | Surface temperature on land | K |
| `sst_sfc_*.nc` | Sea surface temperature | K |
| `swvl1_d1_*.nc` | Volumetric soil water layer 1 | m³/m³ |
| `swvl2_d2_*.nc` | Volumetric soil water layer 2 | m³/m³ |
| `ta_*_*.nc` | Air temperature at 500, 750 and 900 hPa | K [was used for theta e calculations] |
| `tcwv_tot_*.nc` | Thickness of atmosphere mass content of water vapor | kg/m² [total column water vapor] |
| `thetae_*_*.nc` | Equivalent potential temperature at 500, 750 and 900 hPa | K [first calculated dewpoint, then LCL temperature and finally theta e using metpy library] |
| `uwnd_*_*.nc` | Zonal wind at 200, 500 and 850 hPa | - |
| `vwnd_*_*.nc` | Meridional wind at 200, 500 and 850 hPa | - |
